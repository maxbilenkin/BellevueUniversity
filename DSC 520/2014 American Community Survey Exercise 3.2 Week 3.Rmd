---
title: "2014 American Community Survey Exercise 3.2 Week 3"
author: "Maxim Bilenkin"
date: "2024-12-09"
output: pdf_document
---
````markdown
```{r, echo=TRUE}
options(repos = c(CRAN = "https://cloud.r-project.org"))

# Loading the file
loadedfile <- read.csv("C:/Users/maxim/Downloads/acs-14-1yr-s0201.csv")

```{r, include=TRUE}
# Displaying the data structure
invisible(capture.output(str(loadedfile)))

```{r, echo=TRUE, message=FALSE}
library(knitr)
library(kableExtra)

# Extracting variables, data type from loaded file and manually writing intent.
fields_info <- data.frame(
  Field = names(loadedfile),
  Data_Type = sapply(loadedfile, class),
  Intent = c( 
    "Unique identifier for each row", 
    "Simplified version of Id column that only list last four digits.", 
    "Identifies geographic location", 
    "Identifies specific population of the study", 
    "Label of the studied population group", 
    "Number of persons reported their race", 
    "Percent holding high school diploma", 
    "Percent holding Bachelors degree"
  )
)

# 1) List the name of each field and what you believe the data type and intent
#    is of the data included in each field.
# Print data in friendly clean format
kable(fields_info, align='l', row.names = FALSE, 
      caption = "Field/Data Type/Intent") %>% 
  kable_styling(position = "left", full_width = FALSE, 
                bootstrap_options = c("striped", "hover", "condensed"))%>%    
    column_spec(1:3, bold = FALSE, extra_css = "text-align: left;")

# 2) Run the following functions and provide the results: str(); nrow(); ncol()

# Displaying data structure.
str(loadedfile, width=80, strict.width="cut")

# Displaying number of rows.
nrow(loadedfile)

# Displaying number of columns.
cat(ncol(loadedfile))

# 3) Create a Histogram of the HSDegree variable using the ggplot2 package.
# installing ggplot2 package.
library(ggplot2)

# Setting a bin size for the Histogram.
bin_size <- 2

# Creating a histogram.
histogram_plot <- ggplot(loadedfile, aes(x = HSDegree)) + 
    geom_histogram(binwidth = bin_size, fill = "blue", color = "black", 
                   alpha = 0.7) +
    labs(title = "Distribution of HS degrees",
         x = "Percentage of HS degree holders",
         y = "Frequency") +
    theme_minimal() + theme(plot.title = element_text(hjust = 0.5))

print(histogram_plot)

# 4) Answer the following questions based on the Histogram produced:
# Based on what you see in this histogram, is the data distribution unimodal?

# Answer: This distribution seems unimodal because there is only one highest
#         pick at 90% on the x-axis and 30 frequency on the y-axis.

# Is it approximately symmetrical?

# Answer: This histogram not approximately symmetrical. More distribution on 
#         the left side further away from the mean.

# Is it approximately bell-shaped?

# Answer: This distribution not approximately bell-shaped.

# Is it approximately normal?

# Answer: This distribution not approximately normal.

# If not normal, is the distribution skewed? If so, in which direction?

# Answer: This is a negatively skewed distribution. The left tail is longer 
#         than the right tail.

# Include a normal curve to the Histogram that you plotted.
mean_hsdegree <- mean(loadedfile$HSDegree, na.rm = TRUE)
sd_hsdegree <- sd(loadedfile$HSDegree, na.rm = TRUE)


ggplot(loadedfile, aes(x = HSDegree)) + 
    geom_histogram(aes(y = after_stat(density)), binwidth = bin_size, 
    fill = "blue", color = "black", alpha = 0.7) + 
    stat_function(fun = dnorm, 
    args = list(mean = mean_hsdegree, sd = sd_hsdegree), color = "red", 
    linewidth = 1) + labs(title ="Distribution of HS Degrees with Normal Curve", 
     x = "Percentage of High School Degree Holders", 
     y = "Density") + 
    theme_minimal() + theme(plot.title = element_text(hjust = 0.5))

# Explain whether a normal distribution can accurately be used as a model 
# for this data.

# Answer: The normal distribution model cannot be accurately used for this data
#         because it is negatively skewed to the left.


# 5) Create a Probability Plot of the HSDegree variable.
probability_plot <- ggplot(loadedfile, aes(sample = HSDegree)) +
  stat_qq() +
  stat_qq_line() +
  labs(title = "Probability Plot for HSDegree", 
       x = "Theoretical Quantiles",
       y = "Sample Quantiles") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# Print the Q-Q plot
print(probability_plot)

# 6) Answer the following questions based on the Probability Plot:
#    Based on what you see in this probability plot, is the distribution 
#    approximately normal? Explain how you know.

# Answer: The probability plot doesn't look approximately normal because 
#         the end tails deviate substantially from the 45 degree straight line 
#         that follows hypothetical normal distribution.


#    If not normal, is the distribution skewed? If so, in which direction? 
#    Explain how you know.

# Answer: The distribution is negatively skewed. This plot only confirms that 
#          this is a left-sided distribution because the tails deviate toward 
#          down direction on both side from the straight line. If the data from 
#          American survey followed a normal distribution then all or most 
#          points would be plotted on the line or very close to the line. We can
#          see from the image the area between -1 and 1.5 on the x-axis follows 
#          approximately normal distribution since all the points plot on or 
#          very close to the line. But outside of the area the data points plot 
#          away down from the line and the distribution exhibits negative 
#          skewness.

# 7) Now that you have looked at this data visually for normality, you will now 
#    quantify normality with numbers using the stat.desc() function. Include 
#    a screen capture of the results produced.

# Install and load the pastecs package
if (!require(pastecs)) {
  install.packages("pastecs")
}
library(pastecs)

# Calculating descriptive statistics for HSDegree
stats <- stat.desc(loadedfile$HSDegree, basic = TRUE, desc = TRUE, norm = TRUE)

# Converting results to a data frame and storing to the variable.
stats_df <- as.data.frame(stats) 

# Creating and printing data in a readable formatted table vertically. 
kable(stats_df, caption = "Descriptive Statistics for HSDegree", digits = 2) %>%
    kable_styling(full_width = FALSE, position = "left", 
                  bootstrap_options = c("striped", "hover", "condensed")) %>% 
    column_spec(1, width = "5cm")

# Calculating z-scores for HSDegree.
loadedfile$z_scores <- (loadedfile$HSDegree - mean_hsdegree) / sd_hsdegree

# Displaying the first 6 calculated z-scores.
head(loadedfile$z_scores, 6)

# In several sentences provide an explanation of the result produced for skew, 
# kurtosis, and z-scores.

# Answer:  Based on the result the skewness is -1.67 which means this is a
#          negatively skewed distribution. It means most data points concentrate
#          on the higher end with fewer values on the lower end which makes long 
#          tail on the lower end (left side). The value for kurtosis is 4.35.
#          It means it is a leptokurtic distribution because the value above 3.
#          This means the data has significant outliers.From the calculated and 
#          first 6 displayed z-scores we can see that the first four z-scores 
#          are near or very close to zero which mean they are not deviating much
#          from the mean. However, the last or the sixth value of -2.74179676 is
#          more than two standard derivations from below the mean which is a 
#          significant deviation. This means that the data point is a outlier on
#          the left side. This type of outliers make distribution negatively 
#          skewed. 
          
# In addition, explain how a change in the sample size may change your 
# explanation?

# Answer: Increasing sample size will stabilize the distribution and make it 
#         more reliable. It will improve accuracy and reduce impact of outliers.